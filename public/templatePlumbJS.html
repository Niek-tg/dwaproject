<!DOCTYPE html>
<html>
<head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jsPlumb/1.4.1/jquery.jsPlumb-1.4.1-all-min.js"></script>
</head>
<body>

<div id="diagramContainer">
    <div class="stack">
        <div class="frameLabel">Stack</div>
        <div id="frame2" class="frame">
            <div class="frameLabel">Global</div>
            <div class="variable">
                <div class="variableLabel">Var1</div>
                <div id="var1pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var2</div>
                <div id="var2pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var5</div>
            </div>
        </div>
        <div id="frame1" class="frame">
            <div class="frameLabel">Function1</div>
        </div>
    </div>
    <!--end stack-->

    <div class="heap">
        <div class="frameLabel">Heap</div>
        <div id="frame3" class="frame">
            <div class="frameLabel">Ref</div>
            <div class="variable">
                <div class="variableLabel">Var3</div>
                <div id="var3pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var4</div>
                <div id="var4pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var6</div>
                <div id="var6pointer" class="variableValue">123456768566</div>
            </div>
        </div>
        <div id="frame4" class="frame">
            <div class="frameLabel">Function2</div>
        </div>

    </div>
    <!--end heap-->

</div>
<!--end diagramcontainer-->


<script>
    $(document).ready(function () {
        jsPlumb.ready(function () {
            jsPlumb.Defaults.Container = $("#diagramContainer");
            var common = {
                endpoint: "Dot",
                anchor: ["Center", "Center"],
                overlays: [["Arrow", {width: 40, length: 20}]],
                isSource: true,
                isTarget: true
            };

            $(".frame").draggable({
                drag: function (e) {
                    console.log("REPAINTING");
                    jsPlumb.repaintEverything();
                },
                containment: "parent"
            });

            jsPlumb.connect({
                source: "var1pointer",
                target: "var3pointer"
            }, common);

        });
    });
    $(window).resize(function () {
        jsPlumb.repaintEverything();
    })
</script>

</body>
</html>