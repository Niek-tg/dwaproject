<!DOCTYPE html>
<html>
<head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jsPlumb/1.4.1/jquery.jsPlumb-1.4.1-all-min.js"></script>
    <style>
        #diagramContainer {
            padding: 0px;
            width: 100%;
            height: 100%;
            border: 1px solid gray;
            font-size: 20px;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        .stack {
            position: absolute;
            margin: 0px;
            width: 50%;
            height: 600px;
            border: 1px solid gray;
        }

        .heap {
            position: absolute;
            left: 50%;
            margin: 0px;
            width: 50%;
            height: 600px;
            border: 1px solid blue;
        }

        .frame {
            position: relative;
            display: table;
            margin: 3%;
            height: 160px;
            max-width: 300px;
            width: calc(94% - 20px);
            border: 10px solid gray;
        }

        .frameLabel {
            left: 50%;
            text-align: center;
        }

        .variable {
            position: relative;
            float: left;
            width: 96%;
            padding: 0 2%;
            height: 30px;
            margin: 10px 0;
            /*border: 1px solid blue;*/
        }

        .variableLabel {
            float: left;
            margin: 5px;
            width: 50%;
            max-width: 200px;
        }

        .variableValue {
            position: relative;
            float: left;
            right: 2%;
            height: 30px;
            min-width: 30px;
            border: 1px solid gray;
            text-align: center;
        }

    </style>
</head>
<body>
<div id="diagramContainer">
    <div class="stack">
        <div class="frameLabel">Stack</div>
        <div id="frame2" class="frame">
            <div class="frameLabel">Global</div>
            <div class="variable">
                <div class="variableLabel">Var1</div>
                <div id="var1pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var2</div>
                <div id="var2pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var5</div>
            </div>
        </div>
        <div id="frame1" class="frame">
            <div class="frameLabel">Function1</div>
        </div>
    </div>
    <!--end stack-->

    <div class="heap">
        <div class="frameLabel">Heap</div>
        <div id="frame3" class="frame">
            <div class="frameLabel">Ref</div>
            <div class="variable">
                <div class="variableLabel">Var3</div>
                <div id="var3pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var4</div>
                <div id="var4pointer" class="variableValue pointer"></div>
            </div>
            <div class="variable">
                <div class="variableLabel">Var6</div>
                <div id="var6pointer" class="variableValue">123456768566</div>
            </div>
        </div>
        <div id="frame4" class="frame">
            <div class="frameLabel">Function2</div>
        </div>

    </div>
    <!--end heap-->

</div>
<!--end diagramcontainer-->


<script>
    $(document).ready(function () {
        jsPlumb.ready(function () {
            jsPlumb.Defaults.Container = $("#diagramContainer");
            var common = {
                endpoint: "Dot",
                anchor: ["Center", "Center"],
                overlays: [["Arrow", {width: 40, length: 20}]],
                isSource: true,
                isTarget: true
            };

            $(".frame").draggable({
                drag: function (e) {
                    console.log("REPAINTING");
                    jsPlumb.repaintEverything();
                },
                containment: "parent"
            });

            jsPlumb.connect({
                source: "var1pointer",
                target: "var3pointer"
            }, common);

//            jsPlumb.addEndpoint($(".pointer"), common);
        });
    });
    $(window).resize(function () {
        jsPlumb.repaintEverything();
    })
</script>

</body>
</html>